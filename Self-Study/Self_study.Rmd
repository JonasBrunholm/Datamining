---
title: "Self_study"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
Sys.setenv(language="en")
library(tidyverse)
library(magrittr)

```



# data

```{r}

covid <- read_csv("Self-Study/Data_COVID_OWID_per_capita.csv") %>% tibble()

data_pre_filter <- covid %>% 
  mutate(death_percent = TotalDeaths/TotalCases) %>% 
  filter(!is.na(death_percent)) %>% 
  select(-TotalDeaths, -TotalCases)

data_pre_filter %>%
  slice_sample(n = 20) %>%
  ggplot(aes(x = reorder(Country,death_percent), y = death_percent,fill = death_percent)) +
  geom_col()

high_na_percent <- data_pre_filter %>%
  apply(., 2, is.na) %>%
  apply(., 2, sum) %>%
  sort(decreasing = T) %T>% print()

data <- data_pre_filter %>% select(-names(high_na_percent)[1:25])

model <- lm(death_percent ~ ., data = data %>% select(-Country))
summary(model)

```

